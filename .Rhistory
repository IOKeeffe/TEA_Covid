mutate(district_enrollment = sum(ENROLLMENT))
source('~/R/TEA_Covid/tea_reports.R')
source('~/R/TEA_Covid/tea_reports.R')
source('~/R/TEA_Covid/tea_reports.R')
esc_error_counts <- esc_enrollment_data %>%
group_by_at(vars(CRISIS.CODE, CRISIS.CODEX, DISTRICT)) %>%
mutate(district_enrollment = sum(ENROLLMENT)) %>%
ungroup() %>%
group_by_at(vars(CRISIS.CODE, CRISIS.CODEX, REGION)) %>%
mutate(enrollment = sum(district_enrollment)) %>%
ungroup()
source('~/R/TEA_Covid/tea_reports.R')
esc_error_counts <- esc_enrollment_data %>%
group_by_at(vars(CRISIS.CODE, CRISIS.CODEX, DISTRICT)) %>%
mutate(district_enrollment = sum(ENROLLMENT)) %>%
ungroup() %>%
group_by_at(vars(CRISIS.CODE, CRISIS.CODEX, DISTRICT, REGION)) %>%
mutate(enrollment = sum(district_enrollment)) %>%
ungroup()
esc_error_counts <- esc_enrollment_data %>%
group_by_at(vars(CRISIS.CODE, CRISIS.CODEX, DISTRICT)) %>%
mutate(district_enrollment = sum(ENROLLMENT)) %>%
ungroup() %>%
group_by_at(vars(CRISIS.CODE, CRISIS.CODEX, DISTRICT, REGION)) %>%
mutate(enrollment = sum(district_enrollment)) %>%
ungroup()
source('~/R/TEA_Covid/tea_reports.R')
esc_error_counts <- esc_enrollment_data %>%
group_by_at(vars(CRISIS.CODE, CRISIS.CODEX, DISTRICT)) %>%
mutate(district_enrollment = sum(ENROLLMENT)) %>%
ungroup() %>%
group_by_at(vars(CRISIS.CODE, CRISIS.CODEX, DISTRICT, REGION)) %>%
mutate(enrollment = sum(district_enrollment)) %>%
ungroup()
source('~/R/TEA_Covid/tea_reports.R')
source('~/R/TEA_Covid/tea_reports.R')
test <- esc_enrollment_data %>%
group_by(DISTRICT) %>%
summarize(.groups="keep")
test <- esc_enrollment_data %>%
group_by(DISTRICT) %>%
summarize(.groups="keep")
View(test)
View(test)
test <- esc_enrollment_data %>%
group_by(DISTRICT) %>%
summarize(.groups="keep")
source('~/R/TEA_Covid/tea_reports.R')
library(tidyverse)
library(ggplot2)
test <- esc_enrollment_data %>%
group_by(DISTRICT) %>%
summarize(.groups="keep")
View(test)
source('~/R/TEA_Covid/tea_reports.R')
test <- esc_enrollment_data %>%
group_by(DISTRICT) %>%
summarize(STUDENT.COUNT, .groups="keep")
esc_error_counts <- esc_enrollment_data %>%
group_by_at(vars(CRISIS.CODE, CRISIS.CODEX, DISTRICT)) %>%
mutate(district_enrollment = sum(ENROLLMENT)) %>%
ungroup() %>%
group_by_at(vars(CRISIS.CODE, CRISIS.CODEX, REGION)) %>%
mutate(enrollment = sum(district_enrollment)) %>%
ungroup()
source('~/R/TEA_Covid/tea_reports.R')
test <- esc_enrollment_data %>%
group_by(DISTRICT) %>%
summarize(students = sum(STUDENT.COUNT), .groups="keep")
source('~/R/TEA_Covid/tea_reports.R')
test <- esc_enrollment_data %>%
group_by_at(vars(CRISIS.CODE, CRISIS.CODEX, DISTRICT)) %>%
mutate(district_enrollment = sum(ENROLLMENT)) %>%
summarize(district_enrollment, .groups="keep")
source('~/R/TEA_Covid/tea_reports.R')
source('~/R/TEA_Covid/tea_reports.R')
%
test <- esc_enrollment_data %>%
group_by_at(vars(CRISIS.CODE, CRISIS.CODEX, DISTRICT)) %>%
mutate(district_enrollment = sum(ENROLLMENT)) %>%
ungroup() %>%
summarize(district_enrollment)
source('~/R/TEA_Covid/tea_reports.R')
source('~/R/TEA_Covid/tea_reports.R')
test <- esc_enrollment_data %>%
group_by_at(vars(CRISIS.CODE, CRISIS.CODEX, DISTRICT)) %>%
mutate(district_enrollment = sum(ENROLLMENT)) %>%
ungroup() %>%
group_by(REGION) %>%
summarize(district_enrollment, .groups="KEEP")
esc_error_counts <- esc_enrollment_data %>%
group_by_at(vars(CRISIS.CODE, CRISIS.CODEX, DISTRICT)) %>%
mutate(district_enrollment = sum(ENROLLMENT)) %>%
ungroup() %>%
group_by_at(vars(CRISIS.CODE, CRISIS.CODEX, REGION)) %>%
mutate(enrollment = sum(district_enrollment)) %>%
ungroup()
source('~/R/TEA_Covid/tea_reports.R')
source('~/R/TEA_Covid/tea_reports.R')
source('~/R/TEA_Covid/tea_reports.R')
test <- esc_enrollment_data %>%
group_by_at(vars(CRISIS.CODE, CRISIS.CODEX, DISTRICT)) %>%
mutate(district_enrollment = sum(ENROLLMENT)) %>%
ungroup() %>%
group_by(REGION) %>%
summarize(district_enrollment, REGION, .groups="keep")
test <- esc_enrollment_data %>%
group_by_at(vars(CRISIS.CODE, CRISIS.CODEX, DISTRICT)) %>%
mutate(district_enrollment = sum(ENROLLMENT)) %>%
ungroup() %>%
group_by(REGION) %>%
summarize(district_enrollment, REGION, .groups="keep")
test <- esc_enrollment_data %>%
group_by_at(vars(CRISIS.CODE, CRISIS.CODEX, DISTRICT)) %>%
mutate(district_enrollment = sum(ENROLLMENT)) %>%
ungroup() %>%
group_by_at(vars(CRISIS.CODE, CRISIS.CODEX, DISTRICT)) %>%
mutate(enrollment = sum(district_enrollment)) %>%
summarize(district_enrollment, REGION, .groups="keep")
test <- esc_enrollment_data %>%
group_by_at(vars(CRISIS.CODE, CRISIS.CODEX, DISTRICT)) %>%
mutate(district_enrollment = sum(ENROLLMENT)) %>%
ungroup() %>%
group_by_at(vars(CRISIS.CODE, CRISIS.CODEX, DISTRICT)) %>%
mutate(enrollment = sum(district_enrollment)) %>%
summarize(district_enrollment, REGION, enrollment, .groups="keep")
statewide_crisis_data <- merge(crisis_data, cleaned_enrollment_data, by="DISTRICT") %>%
transform(STUDENT.COUNT = as.numeric(gsub(",","",STUDENT.COUNT)))
cleaned_enrollment_data %>%
transform(ENROLLMENT = as.numeric(ENROLLMENT))
cleaned_enrollment_data <- raw_enrollment_data %>%
transform(ENROLLMENT = as.numeric(ENROLLMENT))
esc_enrollment_data <- merge(esc_district_data, cleaned_enrollment_data, by="DISTRICT") %>%
transform(STUDENT.COUNT = as.numeric(gsub(",","",STUDENT.COUNT)))
total_enrollment = sum(district_enrollment_data$ENROLLMENT)
region_enrollment_data = district_enrollment_data %>%
group_by(REGION) %>%
mutate(region_enrollment = sum(ENROLLMENT)) %>%
summarize(REGION, region_enrollment)
region_enrollment_data = esc_enrollment_data %>%
group_by(REGION) %>%
mutate(region_enrollment = sum(ENROLLMENT)) %>%
summarize(REGION, region_enrollment)
esc_enrollment_data <- merge(esc_district_data, district_enrollment_data, by="DISTRICT") %>%
transform(STUDENT.COUNT = as.numeric(gsub(",","",STUDENT.COUNT)))
View(district_enrollment_data)
View(esc_district_data)
View(esc_region_data)
esc_enrollment_data <- merge(esc_crisis_data, district_enrollment_data, by="DISTRICT") %>%
transform(STUDENT.COUNT = as.numeric(gsub(",","",STUDENT.COUNT)))
esc_region_data <- read.csv("DREF.csv")
esc_crisis_data <- merge(crisis_data, esc_region_data, by="DISTRICT")
raw_enrollment_data <- read.csv("Enrollment Report_Statewide_Districts_Gender_2019-2020.csv")
large_districts <- list(246909, 61902, 43910, 101917, 101915, 57909, 71902, 220901, 60902, 43905, 101902, 15910, 79907, 220905, 101914, 227901, 101907, 57905, 244905, 101912)
find_extremes <- function(code) {
return(district_percentages %>%
filter(CRISIS.CODE == code))
}
subtraction_filter <- function(x, y) {
return(ifelse(x>=y,x-y,NaN))
}
district_enrollment_data <- raw_enrollment_data %>%
transform(ENROLLMENT = as.numeric(ENROLLMENT)) %>%
group_by(DISTRICT) %>%
summarize(ENROLLMENT = sum(ENROLLMENT))
total_enrollment = sum(district_enrollment_data$ENROLLMENT)
esc_enrollment_data <- merge(esc_crisis_data, district_enrollment_data, by="DISTRICT") %>%
transform(STUDENT.COUNT = as.numeric(gsub(",","",STUDENT.COUNT)))
region_enrollment_data = merge(esc_region_data, district_enrollment_data, by="DISTRICT") %>%
transform(STUDENT.COUNT = as.numeric(gsub(",","",STUDENT.COUNT))) %>%
group_by(REGION) %>%
mutate(region_enrollment = sum(ENROLLMENT)) %>%
summarize(REGION, region_enrollment)
region_enrollment_data = merge(esc_region_data, district_enrollment_data, by="DISTRICT") %>%
group_by(REGION) %>%
mutate(region_enrollment = sum(ENROLLMENT)) %>%
summarize(REGION, region_enrollment)
View(region_enrollment_data)
region_enrollment_data = merge(esc_region_data, district_enrollment_data, by="DISTRICT") %>%
group_by(REGION) %>%
mutate(region_enrollment = sum(ENROLLMENT)) %>%
summarize(REGION, region_enrollment, .groups="keep")
region_enrollment_data = merge(esc_region_data, district_enrollment_data, by="DISTRICT") %>%
group_by(REGION) %>%
mutate(region_enrollment = sum(ENROLLMENT)) %>%
summarize(REGION, region_enrollment, .groups="keep")
statewide_crisis_data <- merge(crisis_data, district_enrollment_data, by="DISTRICT") %>%
transform(STUDENT.COUNT = as.numeric(gsub(",","",STUDENT.COUNT)))
region_enrollment_data = merge(esc_region_data, district_enrollment_data, by="DISTRICT") %>%
group_by(REGION) %>%
mutate(region_enrollment = sum(ENROLLMENT)) %>%
summarize(REGION, region_enrollment, .groups="keep") %>% distinct()
esc_error_counts <- merge(region_enrollment_data, esc_enrollment_data, by="REGION") %>%
group_by(REGION) %>%
mutate(enrollment = sum(district_enrollment)) %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(region_errors = sum(STUDENT.COUNT == -999)) %>%
mutate(overcounted_crisis_students = subtraction_filter(total_crisis_students, enrollment)) %>%
mutate(undercounted_crisis_students = subtraction_filter(enrollment, total_crisis_students)) %>%
summarize(
REGION,
region_enrollment,
total_crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
overcounted_crisis_students,
undercounted_crisis_students,
region_errors) %>% distinct()
esc_error_counts <- merge(region_enrollment_data, esc_enrollment_data, by="REGION") %>%
group_by(REGION) %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(region_errors = sum(STUDENT.COUNT == -999)) %>%
mutate(overcounted_crisis_students = subtraction_filter(total_crisis_students, enrollment)) %>%
mutate(undercounted_crisis_students = subtraction_filter(enrollment, total_crisis_students)) %>%
summarize(
REGION,
region_enrollment,
total_crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
overcounted_crisis_students,
undercounted_crisis_students,
region_errors) %>% distinct()
esc_error_counts <- merge(region_enrollment_data, esc_enrollment_data, by="REGION") %>%
group_by(REGION) %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(region_errors = sum(STUDENT.COUNT == -999)) %>%
mutate(overcounted_crisis_students = subtraction_filter(total_crisis_students, region_enrollment)) %>%
mutate(undercounted_crisis_students = subtraction_filter(region_enrollment, total_crisis_students)) %>%
summarize(
REGION,
region_enrollment,
total_crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
overcounted_crisis_students,
undercounted_crisis_students,
region_errors) %>% distinct()
View(esc_error_counts)
statewide_error_counts <- statewide_crisis_data %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(errors = sum(STUDENT.COUNT == -999)) %>%
mutate(overcounted_crisis_students = subtraction_filter(total_crisis_students, total_enrollment)) %>%
mutate(undercounted_crisis_students = subtraction_filter(total_enrollment, total_crisis_students)) %>%
summarize(
total_enrollment,
total_crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
overcounted_crisis_students,
undercounted_crisis_students,
errors)
View(statewide_error_counts)
total_enrollment,
total_crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
overcounted_crisis_students,
undercounted_crisis_students,
errors) %>%
distinct()
total_enrollment,
total_crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
overcounted_crisis_students,
undercounted_crisis_students,
errors) %>%
distinct()
statewide_error_counts <- statewide_crisis_data %>%
group_by(CRISIS.CODE)
statewide_error_counts <- statewide_crisis_data %>%
group_by(CRISIS.CODE) %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(errors = sum(STUDENT.COUNT == -999)) %>%
mutate(overcounted_crisis_students = subtraction_filter(total_crisis_students, total_enrollment)) %>%
mutate(undercounted_crisis_students = subtraction_filter(total_enrollment, total_crisis_students)) %>%
summarize(
total_enrollment,
total_crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
overcounted_crisis_students,
undercounted_crisis_students,
errors) %>%
distinct()
statewide_error_counts <- statewide_crisis_data %>%
group_by(CRISIS.CODE) %>%
summarize(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999]))
total_crisis_count = sum(district_enrollment_data$STUDENT.COUNT[STUDENT.COUNT != -999])
total_crisis_count = sum(district_enrollment_data$STUDENT.COUNT[STUDENT.COUNT != -999])
esc_enrollment_data <- merge(esc_crisis_data, district_enrollment_data, by="DISTRICT") %>%
transform(STUDENT.COUNT = as.numeric(gsub(",","",STUDENT.COUNT)))
esc_enrollment_data <- merge(esc_crisis_data, district_enrollment_data, by="DISTRICT") %>%
transform(STUDENT.COUNT = as.numeric(gsub(",","",STUDENT.COUNT)))
statewide_error_counts <- statewide_crisis_data %>%
group_by(CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(errors = sum(STUDENT.COUNT == -999)) %>%
ungroup() %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999]))
statewide_error_counts <- statewide_crisis_data %>%
group_by(CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(errors = sum(STUDENT.COUNT == -999)) %>%
ungroup() %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999]))
statewide_error_counts <- statewide_crisis_data %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
group_by(CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(errors = sum(STUDENT.COUNT == -999)) %>%
mutate(overcounted_crisis_students = subtraction_filter(total_crisis_students, total_enrollment)) %>%
mutate(undercounted_crisis_students = subtraction_filter(total_enrollment, total_crisis_students)) %>%
summarize(
crisis_students,
total_enrollment,
total_crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
overcounted_crisis_students,
undercounted_crisis_students,
errors) %>%
distinct()
View(esc_error_counts)
esc_error_counts <- merge(region_enrollment_data, esc_enrollment_data, by="REGION") %>%
group_by(REGION) %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(region_errors = sum(STUDENT.COUNT == -999)) %>%
mutate(undercounted_crisis_students = subtraction_filter(region_enrollment, total_crisis_students)) %>%
summarize(
REGION,
region_enrollment,
total_crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
undercounted_crisis_students,
region_errors) %>%
distinct()
esc_error_counts <- merge(region_enrollment_data, esc_enrollment_data, by="REGION") %>%
group_by(REGION) %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(region_errors = sum(STUDENT.COUNT == -999)) %>%
mutate(undercounted_crisis_students = subtraction_filter(region_enrollment, total_crisis_students)) %>%
summarize(
REGION,
region_enrollment,
total_crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
undercounted_crisis_students,
region_errors) %>%
distinct()
esc_error_counts <- merge(region_enrollment_data, esc_enrollment_data, by="REGION") %>%
group_by(REGION) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(region_errors = sum(STUDENT.COUNT == -999)) %>%
mutate(undercounted_crisis_students = subtraction_filter(region_enrollment, total_crisis_students)) %>%
summarize(
REGION,
region_enrollment,
crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
undercounted_crisis_students,
region_errors) %>%
distinct()
esc_error_counts <- merge(region_enrollment_data, esc_enrollment_data, by="REGION") %>%
group_by(REGION) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(region_errors = sum(STUDENT.COUNT == -999)) %>%
mutate(undercounted_crisis_students = subtraction_filter(region_enrollment, crisis_students)) %>%
summarize(
REGION,
region_enrollment,
crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
undercounted_crisis_students,
region_errors) %>%
distinct()
View(esc_enrollment_data)
esc_error_counts <- merge(region_enrollment_data, esc_enrollment_data, by="REGION") %>%
group_by(REGION, CRISIS_CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(region_errors = sum(STUDENT.COUNT == -999)) %>%
mutate(undercounted_crisis_students = subtraction_filter(region_enrollment, crisis_students)) %>%
summarize(
REGION,
region_enrollment,
crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
undercounted_crisis_students,
region_errors) %>%
distinct()
esc_error_counts <- merge(region_enrollment_data, esc_enrollment_data, by="REGION") %>%
group_by(REGION, CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(region_errors = sum(STUDENT.COUNT == -999)) %>%
mutate(undercounted_crisis_students = subtraction_filter(region_enrollment, crisis_students)) %>%
summarize(
REGION,
region_enrollment,
crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
undercounted_crisis_students,
region_errors) %>%
distinct()
group_by(REGION, CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(region_errors = sum(STUDENT.COUNT == -999)) %>%
mutate(undercounted_crisis_students = subtraction_filter(region_enrollment, total_crisis_students)) %>%
summarize(
REGION,
region_enrollment,
crisis_students,
total_crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
undercounted_crisis_students,
region_errors) %>%
distinct()
group_by(CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(region_errors = sum(STUDENT.COUNT == -999)) %>%
mutate(undercounted_crisis_students = subtraction_filter(region_enrollment, total_crisis_students)) %>%
summarize(
REGION,
region_enrollment,
crisis_students,
total_crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
undercounted_crisis_students,
region_errors) %>%
distinct()
esc_error_counts <- merge(region_enrollment_data, esc_enrollment_data, by="REGION") %>%
group_by(REGION) %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999]))) %>%
group_by(CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(region_errors = sum(STUDENT.COUNT == -999)) %>%
mutate(undercounted_crisis_students = subtraction_filter(region_enrollment, total_crisis_students)) %>%
summarize(
esc_error_counts <- merge(region_enrollment_data, esc_enrollment_data, by="REGION") %>%
group_by(REGION) %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
group_by(CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(region_errors = sum(STUDENT.COUNT == -999)) %>%
mutate(undercounted_crisis_students = subtraction_filter(region_enrollment, total_crisis_students)) %>%
summarize(
REGION,
region_enrollment,
crisis_students,
total_crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
undercounted_crisis_students,
region_errors) %>%
distinct()
esc_error_counts <- merge(region_enrollment_data, esc_enrollment_data, by="REGION") %>%
group_by(REGION) %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
group_by(CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(region_errors = sum(STUDENT.COUNT == -999)) %>%
mutate(undercounted_crisis_students = subtraction_filter(region_enrollment, total_crisis_students)) %>%
summarize(
REGION,
region_enrollment,
crisis_students,
total_crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
undercounted_crisis_students,
region_errors) %>%
distinct()
esc_error_counts <- merge(region_enrollment_data, esc_enrollment_data, by="REGION") %>%
group_by(REGION) %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
group_by(CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(region_errors = sum(STUDENT.COUNT == -999)) %>%
mutate(undercounted_crisis_students = subtraction_filter(region_enrollment, total_crisis_students)) %>%
summarize(
REGION,
region_enrollment,
crisis_students,
total_crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
undercounted_crisis_students,
region_errors) %>%
distinct()
statewide_error_counts <- statewide_crisis_data %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
group_by(CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(errors = sum(STUDENT.COUNT == -999)) %>%
mutate(undercounted_crisis_students = subtraction_filter(total_enrollment, total_crisis_students)) %>%
summarize(
crisis_students,
total_enrollment,
total_crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
undercounted_crisis_students,
errors) %>%
distinct()
