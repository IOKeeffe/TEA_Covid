region_enrollment_data = merge(esc_region_data, district_enrollment_data, by="DISTRICT") %>%
group_by(REGION) %>%
mutate(region_enrollment = sum(ENROLLMENT)) %>%
summarize(REGION, region_enrollment, .groups="keep") %>%
distinct()
statewide_crisis_data <- merge(crisis_data, district_enrollment_data, by="DISTRICT") %>%
transform(STUDENT.COUNT = as.numeric(gsub(",","",STUDENT.COUNT)))
cleaned_data <- statewide_crisis_data  %>%
filter(STUDENT.COUNT != -999)
large_districts <- cleaned_data %>%
filter(DISTRICT %in% large_district_codes)
large_district_percentages <- large_districts %>%
group_by(DISTRICT) %>%
arrange(sum(STUDENT.COUNT)) %>%
mutate(percent = round(STUDENT.COUNT/sum(STUDENT.COUNT) * 100, digits=2)) %>%
summarize(DISTRICT.NAME, CRISIS.CODEX, CRISIS.CODE, STUDENT.COUNT, percent)
statewide_crisis_summary <- statewide_crisis_data %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
group_by(CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(crisis_percentage = round(crisis_students/statewide_total_enrollment * 100, digits=2)) %>%
mutate(errors = sum(STUDENT.COUNT == -999)) %>%
mutate(error_percentage = round(sum(errors) / (statewide_total_districts * 9) * 100, digits=2)) %>%
mutate(undercounted_crisis_students = subtraction_filter(statewide_total_enrollment, total_crisis_students)) %>%
mutate(undercounted_percentage = round(undercounted_crisis_students/statewide_total_enrollment * 100, digits=2)) %>%
summarize(
crisis_students,
crisis_percentage,
statewide_total_enrollment,
total_crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
undercounted_crisis_students,
undercounted_percentage,
errors,
error_percentage) %>%
distinct()
statewide_crisis_summary <- statewide_crisis_data %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
group_by(CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(crisis_percentage = round(crisis_students/statewide_total_enrollment * 100, digits=2)) %>%
mutate(errors = sum(STUDENT.COUNT == -999)) %>%
mutate(error_percentage = round(sum(errors) / (statewide_total_districts * 9) * 100, digits=2)) %>%
mutate(undercounted_crisis_students = subtraction_filter(statewide_total_enrollment, total_crisis_students)) %>%
mutate(undercounted_percentage = round(undercounted_crisis_students/statewide_total_enrollment * 100, digits=2)) %>%
summarize(
crisis_students,
crisis_percentage,
statewide_total_enrollment,
total_crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
undercounted_crisis_students,
undercounted_percentage,
errors,
error_percentage) %>%
distinct()
statewide_crisis_data <- merge(crisis_data, district_enrollment_data, by="DISTRICT") %>%
transform(STUDENT.COUNT = as.numeric(gsub(",","",STUDENT.COUNT)))
statewide_crisis_data <- merge(completed_crisis_data, district_enrollment_data, by="DISTRICT") %>%
transform(STUDENT.COUNT = as.numeric(gsub(",","",STUDENT.COUNT)))
cleaned_data <- statewide_crisis_data  %>%
filter(STUDENT.COUNT != -999)
View(statewide_crisis_data)
View(statewide_crisis_data)
large_district_data <- large_districts %>%
group_by(DISTRICT) %>%
mutate(district_enrollment = sum(ENROLLMENT)) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(crisis_percentage = round(crisis_students/district_enrollment * 100, digits=2)) %>%
mutate(percent = round(STUDENT.COUNT/sum(STUDENT.COUNT) * 100, digits=2)) %>%
summarize(DISTRICT.NAME, CRISIS.CODEX, CRISIS.CODE, STUDENT.COUNT, percent)
large_districts <- statewide_crisis_data %>%
filter(DISTRICT %in% large_district_codes)
large_district_data <- large_districts %>%
group_by(DISTRICT) %>%
mutate(district_enrollment = sum(ENROLLMENT)) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(crisis_percentage = round(crisis_students/district_enrollment * 100, digits=2)) %>%
mutate(percent = round(STUDENT.COUNT/sum(STUDENT.COUNT) * 100, digits=2)) %>%
summarize(DISTRICT.NAME, CRISIS.CODEX, CRISIS.CODE, STUDENT.COUNT, percent)
View(large_district_codes)
View(large_district_data)
large_district_data <- large_districts %>%
group_by(DISTRICT) %>%
mutate(district_enrollment = sum(ENROLLMENT)) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(crisis_percentage = round(crisis_students/district_enrollment * 100, digits=2)) %>%
summarize(DISTRICT.NAME, CRISIS.CODEX, CRISIS.CODE, crisis_students, crisis_percentage)
large_district_data <- large_districts %>%
group_by(DISTRICT) %>%
mutate(district_enrollment = sum(ENROLLMENT)) %>%
group_by(DISTRICT, CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(crisis_percentage = round(crisis_students/district_enrollment * 100, digits=2)) %>%
summarize(DISTRICT.NAME, CRISIS.CODEX, CRISIS.CODE, crisis_students, crisis_percentage)
large_district_data <- large_districts %>%
group_by(DISTRICT) %>%
mutate(district_enrollment = sum(ENROLLMENT)) %>%
group_by(DISTRICT, CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(crisis_percentage = round(crisis_students/district_enrollment * 100, digits=2)) %>%
summarize(DISTRICT.NAME, CRISIS.CODEX, CRISIS.CODE, district_enrollment, crisis_students, crisis_percentage)
large_district_data <- large_districts %>%
group_by(DISTRICT) %>%
mutate(district_enrollment = sum(ENROLLMENT))
large_district_data <- large_districts %>%
group_by(DISTRICT, CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(crisis_percentage = round(crisis_students/ENROLLMENT * 100, digits=2)) %>%
summarize(DISTRICT.NAME, CRISIS.CODEX, CRISIS.CODE, ENROLLMENT, crisis_students, crisis_percentage)
large_district_data <- large_districts %>%
group_by(DISTRICT, CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(crisis_percentage = round(crisis_students/ENROLLMENT * 100, digits=2)) %>%
mutate(undercounted_crisis_students = subtraction_filter(enrollment, crisis_students)) %>%
summarize(DISTRICT.NAME, CRISIS.CODEX, CRISIS.CODE, ENROLLMENT, crisis_students, crisis_percentage, undercounted_crisis_students)
large_district_data <- large_districts %>%
group_by(DISTRICT, CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(crisis_percentage = round(crisis_students/ENROLLMENT * 100, digits=2)) %>%
mutate(undercounted_crisis_students = subtraction_filter(ENROLLMENT, crisis_students)) %>%
summarize(DISTRICT.NAME, CRISIS.CODEX, CRISIS.CODE, ENROLLMENT, crisis_students, crisis_percentage, undercounted_crisis_students)
large_district_data <- large_districts %>%
group_by(DISTRICT) %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
group_by(DISTRICT, CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(crisis_percentage = round(crisis_students/ENROLLMENT * 100, digits=2)) %>%
mutate(undercounted_crisis_students = subtraction_filter(ENROLLMENT, total_crisis_students)) %>%
summarize(DISTRICT.NAME, CRISIS.CODEX, CRISIS.CODE, ENROLLMENT, crisis_students, crisis_percentage, undercounted_crisis_students)
large_district_data <- large_districts %>%
group_by(DISTRICT) %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
group_by(DISTRICT, CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(crisis_percentage = round(crisis_students/ENROLLMENT * 100, digits=2)) %>%
mutate(undercounted_crisis_students = subtraction_filter(ENROLLMENT, total_crisis_students)) %>%
summarize(DISTRICT.NAME, CRISIS.CODEX, CRISIS.CODE, ENROLLMENT, total_crisis_students, crisis_students, crisis_percentage, undercounted_crisis_students)
statewide_crisis_summary <- statewide_crisis_data %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
group_by(CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(crisis_percentage = round(crisis_students/statewide_total_enrollment * 100, digits=2)) %>%
mutate(errors = sum(STUDENT.COUNT == -999)) %>%
mutate(error_percentage = round(sum(errors) / (statewide_total_districts * 9) * 100, digits=2)) %>%
mutate(undercounted_crisis_students = subtraction_filter(statewide_total_enrollment, total_crisis_students)) %>%
mutate(undercounted_percentage = round(undercounted_crisis_students/statewide_total_enrollment * 100, digits=2)) %>%
summarize(
crisis_students,
crisis_percentage,
statewide_total_enrollment,
total_crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
undercounted_crisis_students,
undercounted_percentage,
errors,
error_percentage) %>%
distinct()
View(statewide_crisis_summary)
statewide_crisis_summary <- statewide_crisis_data %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
group_by(CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(crisis_percentage = round(crisis_students/statewide_total_enrollment * 100, digits=2)) %>%
mutate(errors = sum(STUDENT.COUNT == -999)) %>%
mutate(error_percentage = round(sum(errors) / (statewide_total_districts * 9) * 100, digits=2)) %>%
mutate(undercounted_crisis_students = subtraction_filter(statewide_total_enrollment, total_crisis_students)) %>%
mutate(undercounted_percentage = round(undercounted_crisis_students/statewide_total_enrollment * 100, digits=2)) %>%
summarize(
crisis_students,
crisis_percentage,
statewide_total_enrollment,
total_crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
undercounted_crisis_students,
undercounted_percentage,
errors,
error_percentage) %>%
distinct()
View(statewide_crisis_summary)
View(completed_crisis_data)
completed_crisis_data = raw_crisis_data %>%
complete(DISTRICT, nesting(CRISIS.CODE), fill=list(STUDENT.COUNT = -999)) %>%
select(-c(YEAR, CRISIS.CODEX, DISTRICT.NAME))
esc_region_data <- read.csv("DREF.csv")
esc_crisis_data <- merge(completed_crisis_data, esc_region_data, by="DISTRICT")
raw_enrollment_data <- read.csv("Enrollment Report_Statewide_Districts_Gender_2019-2020.csv")
large_district_codes <- list(246909, 61902, 43910, 101917, 101915, 57909, 71902, 220901, 60902, 43905, 101902, 15910, 79907, 220905, 101914, 227901, 101907, 57905, 244905, 101912)
crisis_codes <- c("7A", "7B", "7C", "7D", "7E", "7F", "7G", "7H", "7I")
find_extremes <- function(code) {
return(district_percentages %>%
filter(CRISIS.CODE == code))
}
subtraction_filter <- function(x, y) {
return(ifelse(x>=y,x-y,NaN))
}
district_enrollment_data <- raw_enrollment_data %>%
transform(ENROLLMENT = as.numeric(ENROLLMENT)) %>%
group_by(DISTRICT) %>%
summarize(ENROLLMENT = sum(ENROLLMENT))
statewide_total_enrollment = sum(district_enrollment_data$ENROLLMENT)
statewide_total_districts = length(unique(esc_crisis_data$DISTRICT.NAME))
statewide_errors = nrow(subset(esc_crisis_data, STUDENT.COUNT==-999))
esc_enrollment_data <- merge(esc_crisis_data, district_enrollment_data, by="DISTRICT") %>%
transform(STUDENT.COUNT = as.numeric(gsub(",","",STUDENT.COUNT)))
region_enrollment_data = merge(esc_region_data, district_enrollment_data, by="DISTRICT") %>%
group_by(REGION) %>%
mutate(region_enrollment = sum(ENROLLMENT)) %>%
summarize(REGION, region_enrollment, .groups="keep") %>%
distinct()
statewide_crisis_data <- merge(completed_crisis_data, district_enrollment_data, by="DISTRICT") %>%
transform(STUDENT.COUNT = as.numeric(gsub(",","",STUDENT.COUNT)))
large_districts <- statewide_crisis_data %>%
filter(DISTRICT %in% large_district_codes)
large_district_data <- large_districts %>%
group_by(DISTRICT) %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
group_by(DISTRICT, CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(crisis_percentage = round(crisis_students/ENROLLMENT * 100, digits=2)) %>%
mutate(undercounted_crisis_students = subtraction_filter(ENROLLMENT, total_crisis_students)) %>%
summarize(DISTRICT.NAME, CRISIS.CODEX, CRISIS.CODE, ENROLLMENT, total_crisis_students, crisis_students, crisis_percentage, undercounted_crisis_students)
statewide_crisis_summary <- statewide_crisis_data %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
group_by(CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(crisis_percentage = round(crisis_students/statewide_total_enrollment * 100, digits=2)) %>%
mutate(errors = sum(STUDENT.COUNT == -999)) %>%
mutate(error_percentage = round(sum(errors) / (statewide_total_districts * 9) * 100, digits=2)) %>%
mutate(undercounted_crisis_students = subtraction_filter(statewide_total_enrollment, total_crisis_students)) %>%
mutate(undercounted_percentage = round(undercounted_crisis_students/statewide_total_enrollment * 100, digits=2)) %>%
summarize(
crisis_students,
crisis_percentage,
statewide_total_enrollment,
total_crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
undercounted_crisis_students,
undercounted_percentage,
errors,
error_percentage) %>%
distinct()
statewide_crisis_summary <- statewide_crisis_data %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
group_by(CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(crisis_percentage = round(crisis_students/statewide_total_enrollment * 100, digits=2)) %>%
mutate(errors = sum(STUDENT.COUNT == -999)) %>%
mutate(error_percentage = round(sum(errors) / (statewide_total_districts * 9) * 100, digits=2)) %>%
mutate(undercounted_crisis_students = subtraction_filter(statewide_total_enrollment, total_crisis_students)) %>%
mutate(undercounted_percentage = round(undercounted_crisis_students/statewide_total_enrollment * 100, digits=2)) %>%
summarize(
crisis_students,
crisis_percentage,
statewide_total_enrollment,
total_crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
undercounted_crisis_students,
undercounted_percentage,
errors,
error_percentage) %>%
distinct()
statewide_crisis_data <- merge(completed_crisis_data, district_enrollment_data, by="DISTRICT") %>%
transform(STUDENT.COUNT = as.numeric(gsub(",","",STUDENT.COUNT)))
large_districts <- statewide_crisis_data %>%
filter(DISTRICT %in% large_district_codes)
large_district_data <- large_districts %>%
group_by(DISTRICT) %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
group_by(DISTRICT, CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(crisis_percentage = round(crisis_students/ENROLLMENT * 100, digits=2)) %>%
mutate(undercounted_crisis_students = subtraction_filter(ENROLLMENT, total_crisis_students)) %>%
summarize(DISTRICT.NAME, CRISIS.CODEX, CRISIS.CODE, ENROLLMENT, total_crisis_students, crisis_students, crisis_percentage, undercounted_crisis_students)
large_district_data <- large_districts %>%
group_by(DISTRICT) %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
group_by(DISTRICT, CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(crisis_percentage = round(crisis_students/ENROLLMENT * 100, digits=2)) %>%
mutate(undercounted_crisis_students = subtraction_filter(ENROLLMENT, total_crisis_students)) %>%
summarize(DISTRICT.NAME, CRISIS.CODE, ENROLLMENT, total_crisis_students, crisis_students, crisis_percentage, undercounted_crisis_students)
statewide_crisis_summary <- statewide_crisis_data %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
group_by(CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(crisis_percentage = round(crisis_students/statewide_total_enrollment * 100, digits=2)) %>%
mutate(errors = sum(STUDENT.COUNT == -999)) %>%
mutate(error_percentage = round(sum(errors) / (statewide_total_districts * 9) * 100, digits=2)) %>%
mutate(undercounted_crisis_students = subtraction_filter(statewide_total_enrollment, total_crisis_students)) %>%
mutate(undercounted_percentage = round(undercounted_crisis_students/statewide_total_enrollment * 100, digits=2)) %>%
summarize(
crisis_students,
crisis_percentage,
statewide_total_enrollment,
total_crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
undercounted_crisis_students,
undercounted_percentage,
errors,
error_percentage) %>%
distinct()
completed_crisis_data = raw_crisis_data %>%
complete(DISTRICT, nesting(CRISIS.CODE), fill=list(STUDENT.COUNT = -999)) %>%
fill(CRISIS.CODEX) %>%
fill(DISTRICT.NAME) %>%
select(-c(YEAR))
completed_crisis_data = raw_crisis_data %>%
complete(DISTRICT, nesting(CRISIS.CODE), fill=list(STUDENT.COUNT = -999, CRISIS.CODEX=crisis_codes)) %>%
fill(DISTRICT.NAME) %>%
select(-c(YEAR))
completed_crisis_data = raw_crisis_data %>%
complete(DISTRICT, nesting(CRISIS.CODE), fill=list(STUDENT.COUNT = -999),  CRISIS.CODEX=crisis_codes) %>%
fill(DISTRICT.NAME) %>%
select(-c(YEAR))
completed_crisis_data = raw_crisis_data %>%
complete(DISTRICT, nesting(CRISIS.CODE, CRISIS.CODEX), fill=list(STUDENT.COUNT = -999)) %>%
fill(DISTRICT.NAME) %>%
select(-c(YEAR))
completed_crisis_data = raw_crisis_data %>%
complete(DISTRICT, nesting(CRISIS.CODE, CRISIS.CODEX), fill=list(STUDENT.COUNT = -999)) %>%
fill(DISTRICT.NAME) %>%
select(-c(YEAR))
esc_region_data <- read.csv("DREF.csv")
esc_crisis_data <- merge(completed_crisis_data, esc_region_data, by="DISTRICT")
raw_enrollment_data <- read.csv("Enrollment Report_Statewide_Districts_Gender_2019-2020.csv")
large_district_codes <- list(246909, 61902, 43910, 101917, 101915, 57909, 71902, 220901, 60902, 43905, 101902, 15910, 79907, 220905, 101914, 227901, 101907, 57905, 244905, 101912)
find_extremes <- function(code) {
return(district_percentages %>%
filter(CRISIS.CODE == code))
}
subtraction_filter <- function(x, y) {
return(ifelse(x>=y,x-y,NaN))
}
district_enrollment_data <- raw_enrollment_data %>%
transform(ENROLLMENT = as.numeric(ENROLLMENT)) %>%
group_by(DISTRICT) %>%
summarize(ENROLLMENT = sum(ENROLLMENT))
statewide_total_enrollment = sum(district_enrollment_data$ENROLLMENT)
statewide_total_districts = length(unique(esc_crisis_data$DISTRICT.NAME))
statewide_errors = nrow(subset(esc_crisis_data, STUDENT.COUNT==-999))
esc_enrollment_data <- merge(esc_crisis_data, district_enrollment_data, by="DISTRICT") %>%
transform(STUDENT.COUNT = as.numeric(gsub(",","",STUDENT.COUNT)))
region_enrollment_data = merge(esc_region_data, district_enrollment_data, by="DISTRICT") %>%
group_by(REGION) %>%
mutate(region_enrollment = sum(ENROLLMENT)) %>%
summarize(REGION, region_enrollment, .groups="keep") %>%
distinct()
statewide_crisis_data <- merge(completed_crisis_data, district_enrollment_data, by="DISTRICT") %>%
transform(STUDENT.COUNT = as.numeric(gsub(",","",STUDENT.COUNT)))
large_districts <- statewide_crisis_data %>%
filter(DISTRICT %in% large_district_codes)
large_district_data <- large_districts %>%
group_by(DISTRICT) %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
group_by(DISTRICT, CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(crisis_percentage = round(crisis_students/ENROLLMENT * 100, digits=2)) %>%
mutate(undercounted_crisis_students = subtraction_filter(ENROLLMENT, total_crisis_students)) %>%
summarize(DISTRICT.NAME, CRISIS.CODE, ENROLLMENT, total_crisis_students, crisis_students, crisis_percentage, undercounted_crisis_students)
statewide_crisis_summary <- statewide_crisis_data %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
group_by(CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(crisis_percentage = round(crisis_students/statewide_total_enrollment * 100, digits=2)) %>%
mutate(errors = sum(STUDENT.COUNT == -999)) %>%
mutate(error_percentage = round(sum(errors) / (statewide_total_districts * 9) * 100, digits=2)) %>%
mutate(undercounted_crisis_students = subtraction_filter(statewide_total_enrollment, total_crisis_students)) %>%
mutate(undercounted_percentage = round(undercounted_crisis_students/statewide_total_enrollment * 100, digits=2)) %>%
summarize(
crisis_students,
crisis_percentage,
statewide_total_enrollment,
total_crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
undercounted_crisis_students,
undercounted_percentage,
errors,
error_percentage) %>%
distinct()
View(statewide_crisis_summary)
statewide_crisis_summary <- statewide_crisis_data %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
group_by(CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(crisis_percentage = round(crisis_students/statewide_total_enrollment * 100, digits=2)) %>%
mutate(errors = sum(STUDENT.COUNT == -999)) %>%
mutate(error_percentage = round(sum(errors) / (statewide_total_districts * 9) * 100, digits=2)) %>%
mutate(undercounted_crisis_students = subtraction_filter(statewide_total_enrollment, total_crisis_students)) %>%
mutate(undercounted_percentage = round(undercounted_crisis_students/statewide_total_enrollment * 100, digits=2)) %>%
summarize(
crisis_students,
crisis_percentage,
statewide_total_enrollment,
total_crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
undercounted_crisis_students,
undercounted_percentage,
errors,
error_percentage) %>%
distinct()
statewide_total_errors = nrow(subset(esc_crisis_data, STUDENT.COUNT==-999))
statewide_crisis_data <- merge(completed_crisis_data, district_enrollment_data, by="DISTRICT") %>%
transform(STUDENT.COUNT = as.numeric(gsub(",","",STUDENT.COUNT)))
View(statewide_crisis_data)
completed_crisis_data %>%
arrange(STUDENT.COUNT)
View(completed_crisis_data)
temp = completed_crisis_data %>%
arrange(STUDENT.COUNT)
View(temp)
statewide_total_entries = nrow(esc_crisis_data)
View(esc_crisis_data)
statewide_crisis_summary <- statewide_crisis_data %>%
mutate(total_crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
group_by(CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(crisis_percentage = round(crisis_students/statewide_total_enrollment * 100, digits=2)) %>%
mutate(errors = sum(STUDENT.COUNT == -999)) %>%
mutate(error_percentage = round(statewide_total_errors / statewide_total_entries * 100, digits=2)) %>%
mutate(undercounted_crisis_students = subtraction_filter(statewide_total_enrollment, total_crisis_students)) %>%
mutate(undercounted_percentage = round(undercounted_crisis_students/statewide_total_enrollment * 100, digits=2)) %>%
summarize(
crisis_students,
crisis_percentage,
statewide_total_enrollment,
total_crisis_students,
CRISIS.CODE,
CRISIS.CODEX,
undercounted_crisis_students,
undercounted_percentage,
errors,
error_percentage) %>%
distinct()
esc_crisis_counts <- merge(region_enrollment_data, esc_enrollment_data, by="REGION") %>%
group_by(REGION) %>%
mutate(region_districts = length(unique(DISTRICT.NAME))) %>%
mutate(region_errors = sum(STUDENT.COUNT == -999)) %>%
mutate(total_region_crisis_count = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(undercounted_crisis_students = subtraction_filter(region_enrollment, total_region_crisis_count)) %>%
group_by(REGION, CRISIS.CODE) %>%
mutate(crisis_students = sum(STUDENT.COUNT[STUDENT.COUNT != -999])) %>%
mutate(crisis_percentage = round(crisis_students/region_enrollment * 100, digits=2))
View(esc_crisis_counts)
# crisis_students is total students counted in data, enrollment is official numbers.
esc_crisis_display <- esc_crisis_counts %>%
summarize(
REGION,
crisis_students,
crisis_percentage,
CRISIS.CODE,
CRISIS.CODEX) %>%
distinct()
View(esc_crisis_display)
# error_percentage is how many errors (missing crisis code or -999 data) an esc region has compared to total possible reporting
# crisis_grade is a score based on how many students are engaged out of max possible.
# undercounted compares crisis reported students vs. official enrollment number
esc_region_summary <- esc_crisis_counts %>%
group_by(REGION) %>%
mutate(total_districts = sum(region_districts)) %>%
mutate(CRISIS.SCORE = case_when(
CRISIS.CODE == "7A" ~ 4 * crisis_students,
CRISIS.CODE %in% list('7D', '7G') ~ 3 * crisis_students,
CRISIS.CODE %in% list('7C', '7F', '7H', '7I') ~ 2 * crisis_students,
CRISIS.CODE == "7E" ~ 1 * crisis_students,
CRISIS.CODE == "7B" ~ 0)) %>%
mutate(total_crisis_score = sum(CRISIS.SCORE)) %>%
mutate(max_crisis_score = sum(crisis_students) * 4) %>%
mutate(crisis_grade = round(total_crisis_score / max_crisis_score * 100, digits=2)) %>%
mutate(region_error_percentage = round(region_errors/(region_districts * 9) * 100, digits=2)) %>%
mutate(undercounted_percentage = round(undercounted_crisis_students/region_enrollment * 100, digits=2)) %>%
mutate(error_percentage = round(region_errors / region_districts * 9, digits=2)) %>%
summarize(
REGION,
region_districts,
region_enrollment,
total_region_crisis_count,
undercounted_percentage,
region_errors,
error_percentage,
crisis_grade,
.groups = "keep"
) %>%
distinct()
View(esc_region_summary)
CRISIS.CODE == "7A" ~ 4 * crisis_students,
CRISIS.CODE %in% list('7D', '7G') ~ 3 * crisis_students,
CRISIS.CODE %in% list('7C', '7F', '7H', '7I') ~ 2 * crisis_students,
CRISIS.CODE == "7E" ~ 1 * crisis_students,
CRISIS.CODE == "7B" ~ 0)) %>%
mutate(total_crisis_score = sum(CRISIS.SCORE)) %>%
mutate(max_crisis_score = sum(crisis_students) * 4) %>%
mutate(crisis_grade = round(total_crisis_score / max_crisis_score * 100, digits=2)) %>%
mutate(region_error_percentage = round((region_errors/(region_districts * 9)) * 100, digits=2)) %>%
mutate(undercounted_percentage = round(undercounted_crisis_students/region_enrollment * 100, digits=2)) %>%
mutate(error_percentage = round(region_errors / region_districts * 9, digits=2)) %>%
summarize(
View(esc_crisis_display)
View(esc_crisis_display)
View(esc_crisis_display)
View(esc_crisis_counts)
View(esc_crisis_display)
View(esc_region_summary)
